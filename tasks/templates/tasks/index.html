{% extends "base.html" %}

{% block title %}Tâches | Task Manager{% endblock %}

{% block content %}
<form method="post">
  {% csrf_token %}
  {{ form.title }}
  {{ form.deadline }}
  {{ form.description }}
  <button class="btn-add" type="submit"><i class="fa-solid fa-plus"></i> Ajouter</button>
</form>

{% for task in tasks %}
  <div class="task">
    <div class="left">
      <div style="display:flex;flex-direction:column;">
        <div class="title">
          <h2>{{ task.title }}</h2>
          <p>{{ task.description }}</p>
        </div>
        <div class="meta">
          {% if task.deadline %}
            {% if task.deadline < now and not task.completed %}
              <span class="overdue"><i class="fa-solid fa-clock"></i> En retard</span>
            {% elif task.completed %}
              <span class="done"><i class="fa-solid fa-circle-check"></i> Déjà réalisé</span>
            {% endif %}
            <i class="fa-regular fa-clock"></i> {{ task.deadline|date:"d M Y H:i" }}
          {% endif %}
        </div>
      </div>
    </div>

    <div class="actions">
      {% if not task.completed %}
        <a href="{% url 'toggle_task' task.id %}" class="icon-btn done" title="Terminer">
          <i class="fa-solid fa-check"></i>
        </a>
      {% endif %}
      <a href="{% url 'delete_task' task.id %}" class="icon-btn delete" title="Supprimer">
        <i class="fa-solid fa-trash"></i>
      </a>
    </div>
  </div>
{% empty %}
  <p style="text-align:center;color:var(--muted);">Aucune tâche pour l’instant.</p>
{% endfor %}
{% endblock %}
